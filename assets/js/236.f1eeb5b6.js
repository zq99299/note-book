(window.webpackJsonp=window.webpackJsonp||[]).push([[236],{1388:function(s,n,a){s.exports=a.p+"assets/img/image-20200715131405149.1fbf837b.png"},2132:function(s,n,a){"use strict";a.r(n);var t=a(13),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,t=s._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"nginx-lua-webhook-è‡ªåŠ¨åŒ–éƒ¨ç½²"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx-lua-webhook-è‡ªåŠ¨åŒ–éƒ¨ç½²"}},[s._v("#")]),s._v(" nginx + lua + webhook è‡ªåŠ¨åŒ–éƒ¨ç½²")]),s._v(" "),t("p",[s._v("å¦‚æœå°† vuepress build ä¹‹åçš„é™æ€ç½‘ç«™éƒ¨ç½²åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªè‡ªåŠ¨åŒ–æ–¹æ¡ˆï¼Œæ€è·¯å¦‚ä¸‹ï¼š")]),s._v(" "),t("ol",[t("li",[s._v("åœ¨ linux æœåŠ¡å™¨ä¸Šå®‰è£… nodeã€yarnã€gitã€nginx è½¯ä»¶")]),s._v(" "),t("li",[s._v("ç¼–å†™ä¸€ä¸ªè„šæœ¬ï¼šç”¨äºæ›´æ–° git ä»“åº“é¡¹ç›®ï¼Œç„¶å buildï¼Œå†å¤åˆ¶åˆ° nginx é…ç½®è®¿é—®çš„æ–‡ä»¶ä½ç½®")]),s._v(" "),t("li",[s._v("ä½¿ç”¨ nginx æ¥ä½œä¸ºé™æ€ç½‘ç«™çš„å®¹å™¨")]),s._v(" "),t("li",[s._v("ä½¿ç”¨ nginx lua æ¨¡å—æä¾›ä¸€ä¸ªè°ƒç”¨è„šæœ¬çš„å…¥å£")]),s._v(" "),t("li",[s._v("åœ¨ github ä¸Šå¡«å†™ webhook åœ°å€ä¸ºï¼Œè°ƒç”¨è„šæœ¬çš„å…¥å£åœ°å€")]),s._v(" "),t("li",[s._v("è¾¾åˆ°ï¼šä¸Šä¼ åˆ° github åï¼Œè§¦å‘ webhook äº‹ä»¶ï¼ŒæœåŠ¡å™¨è‡ªåŠ¨æ„å»ºå¹¶å‘å¸ƒæ–°ç¬”è®°å†…å®¹çš„åŠŸèƒ½")])]),s._v(" "),t("h2",{attrs:{id:"å®‰è£…-openresty-lua-ç›¸å…³ä¾èµ–åŒ…"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…-openresty-lua-ç›¸å…³ä¾èµ–åŒ…"}},[s._v("#")]),s._v(" å®‰è£… OpenResty + lua ç›¸å…³ä¾èµ–åŒ…")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://zq99299.github.io/note-book/cache-pdp/052.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("å®‰è£… OpenResty å’Œ lua å…¥é—¨è¯·å‚è€ƒæœ¬æ–‡ç« "),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("è¯·æŒ‰è¯¥æ–‡ç« å®Œæˆå®‰è£…åï¼Œå¹¶å®Œæˆ  hello world lua çš„æµ‹è¯•ï¼Œå†ç»§ç»­ä¸‹é¢çš„æ­¥éª¤")]),s._v(" "),t("h2",{attrs:{id:"nginx-æ‰§è¡Œ-shell-è„šæœ¬"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx-æ‰§è¡Œ-shell-è„šæœ¬"}},[s._v("#")]),s._v(" nginx æ‰§è¡Œ shell è„šæœ¬")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://blog.csdn.net/weixin_40429878/article/details/81908019",target:"_blank",rel:"noopener noreferrer"}},[s._v("æœ¬èŠ‚å†…å®¹å‚è€ƒæ–‡ç« "),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("è¦åœ¨ nginx ä¸‹æ‰§è¡Œ shell è„šæœ¬ï¼Œä¸»è¦ä½¿ç”¨ä»¥ä¸‹ä¸¤ä¸ªè½¯ä»¶ï¼š")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("lua-resty-shell")]),s._v(" æ¨¡å—")]),s._v(" "),t("li",[t("strong",[s._v("sockproc")])])]),s._v(" "),t("p",[s._v("lua-resty-shell é€šè¿‡ sockproc å»æ‰§è¡Œ shell å‘½ä»¤ï¼Œå¹¶è¿”å›æ‰§è¡Œç»“æœ")]),s._v(" "),t("h3",{attrs:{id:"å®‰è£…-sockproc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…-sockproc"}},[s._v("#")]),s._v(" å®‰è£… sockproc")]),s._v(" "),t("p",[s._v("éšæ„æŠŠ sockproc å®‰è£…åœ¨å“ªé‡Œï¼ŒæŒ‰ä½ è‡ªå·±çš„ä¹ æƒ¯ï¼Œåªè¦èƒ½è¿è¡Œä¸Šå°±è¡Œ")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("git clone https"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("github"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("juce"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sockproc\ncd sockproc\nmake\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/sockproc "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tmp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("shell"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sock\nchmod "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0666")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tmp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("shell"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sock\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("sockproc æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ç¨‹åºï¼Œä¾¦æµ‹ unix socket æˆ–è€… tcp socket ï¼Œ å¹¶æŠŠæ”¶åˆ°çš„å‘½ä»¤ï¼Œä¼ é€’ç»™å­è¿›ç¨‹æ‰§è¡Œï¼Œæ‰§è¡Œå®Œæ¯•åï¼ŒæŠŠç»“æœè¿”å›ç»™å®¢æˆ·ç«¯,ï¼Œæˆ‘ä»¬å°±è®© sockproc ä¾¦æµ‹ "),t("code",[s._v("/tmp/shell.sock")]),s._v(" çš„å¥—æ¥å£æœ‰æ²¡æœ‰æ•°æ®åˆ°æ¥ã€‚")]),s._v(" "),t("h3",{attrs:{id:"å®‰è£…-lua-resty-shell-æ¨¡å—"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…-lua-resty-shell-æ¨¡å—"}},[s._v("#")]),s._v(" å®‰è£… lua-resty-shell æ¨¡å—")]),s._v(" "),t("p",[s._v("å®ƒæ˜¯ä¸€ä¸ªå¾ˆå°çš„åº“ï¼Œé…åˆ openresty ä½¿ç”¨ï¼Œç›®çš„æ˜¯æä¾›ç±»ä¼¼äº os.execute æˆ– io.popen çš„åŠŸèƒ½ï¼Œ å”¯ä¸€åŒºåˆ«å®ƒæ˜¯éé˜»å¡çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å³ä½¿éœ€è¦è€—æ—¶å¾ˆä¹…çš„å‘½ä»¤ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒ")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åŒæ ·ï¼Œåœ¨ä»»æ„ç›®å½•ä¸‹ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦æ‹¿åˆ°ä»“åº“é‡Œé¢çš„ shell.lua æ–‡ä»¶è€Œå·²")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/juce/lua-resty-shell\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" lua-resty-shell\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æŠŠ shell.lua æ–‡ä»¶å¤åˆ¶åˆ° openResty ä¸­é…ç½®çš„ lualib ç›®å½•ä¸­")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å¦‚æœæ˜¯æŒ‰ç…§ä¸Šé¢æ•™ç¨‹å®‰è£…çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ lualibè·¯å¾„å°±å¦‚ä¸‹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/servers/lualib/resty/\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" lib/resty/shell.lua /usr/servers/lualib/resty/ \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"æµ‹è¯•æ‰§è¡Œ-shell-è„šæœ¬"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æµ‹è¯•æ‰§è¡Œ-shell-è„šæœ¬"}},[s._v("#")]),s._v(" æµ‹è¯•æ‰§è¡Œ shell è„šæœ¬")]),s._v(" "),t("p",[s._v("åˆ›å»ºä¸€ä¸ª lua è„šæœ¬æ–‡ä»¶")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /usr/servers/nginx/conf/test.lua\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" shell "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" require "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"resty.shell"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" args "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    socket "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unix:/tmp/shell.sock"')]),s._v(",  -- è¿™æ˜¯ç¬¬ä¸€æ­¥çš„ unxi socket\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" status, out, err "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" shell.execute"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ls"')]),s._v(", args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  -- "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" æ˜¯æƒ³è°ƒç”¨çš„å‘½ä»¤,\nngx.header.content_type "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text/plain"')]),s._v("\nngx.say"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Result:'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(" out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                    -- å‘½ä»¤è¾“å‡ºç»“æœ\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("ä¿®æ”¹ nginx é…ç½®")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /usr/servers/nginx/conf/lua.conf \n\nserver "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("  \n    listen       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9300")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  \n    server_name  _"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    location /lua "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("  \n      default_type "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'text/html'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  \n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# content_by_lua 'ngx.say(\"hello world\")';  ")]),s._v("\n      content_by_lua_file /usr/servers/nginx/conf/test.lua"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("  \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[s._v("é‡æ–°åŠ è½½ nginx é…ç½®æ–‡ä»¶åï¼Œè®¿é—® 9300 ç«¯å£ï¼Œå°±å¯ä»¥çœ‹åˆ° ls å‘½ä»¤æ‰§è¡Œåè¾“å‡ºçš„å†…å®¹äº†")]),s._v(" "),t("h2",{attrs:{id:"ç¼–å†™æ¥å—-webhook-çš„é€»è¾‘-lua-è„šæœ¬"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç¼–å†™æ¥å—-webhook-çš„é€»è¾‘-lua-è„šæœ¬"}},[s._v("#")]),s._v(" ç¼–å†™æ¥å— webhook çš„é€»è¾‘ lua è„šæœ¬")]),s._v(" "),t("p",[s._v("æˆ‘ä»¬çš„è¿™é‡Œçš„æ€è·¯ç®€å•ä¸€ç‚¹ï¼š")]),s._v(" "),t("ol",[t("li",[s._v("æä¾›ä¸€ä¸ªè®¿é—®åœ°å€ï¼Œæ¥å— webhook è¯·æ±‚ï¼Œè¯·æ±‚çš„æ—¶å€™éœ€è¦æºå¸¦ä¸€ä¸ª token å‚æ•°")]),s._v(" "),t("li",[s._v("åœ¨ lua è„šæœ¬ä¸­è·å–è¿™ä¸ª token å‚æ•°ï¼Œå¹¶æ ¡éªŒæ˜¯å¦è‡ªå·±è®¾ç½®çš„ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™ç›´æ¥ä¸¢å¼ƒè¿™ä¸ªè¯·æ±‚")]),s._v(" "),t("li",[s._v("æ‰§è¡Œç¬”è®°æ„å»ºéƒ¨ç½²è„šæœ¬")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("-- æ‹¿ä¸€ä¸ªåœ°å€æ¥è¯´æ˜ï¼šhttp://eshop-cache03/lua?method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("hello"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("productId")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n-- è·å–é—®å·åé¢çš„å‚æ•°åˆ—è¡¨\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" uri_args "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ngx.req.get_uri_args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n-- è·å–å‚æ•°\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" token "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" uri_args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"token"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" checkToken "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456xxx"')]),s._v("\n\n-- å¦‚æœæ²¡æœ‰æä¾› token åˆ™è¾“å‡ºä¸€ä¸ª err ä¿¡æ¯\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" not token "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("  \n    ngx.say"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"request error :"')]),s._v(", err"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  \n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v("  \nend\n\n-- åˆ¤æ–­æ˜¯å¦ä¸ token ç›¸ç­‰\nif"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" token "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" checkToken "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n    ngx.say"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"request error :"')]),s._v(", err"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  \n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v("  \nend\n\n-- æ ¡éªŒé€šè¿‡åï¼Œæ‰§è¡Œè„šæœ¬\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" shell "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" require "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"resty.shell"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" args "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    socket "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unix:/tmp/shell.sock"')]),s._v(", \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" status, out, err "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" shell.execute"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sh /xx/build.sh"')]),s._v(", args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  \nngx.header.content_type "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text/plain"')]),s._v("\nngx.say"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Result:'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(" out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("p",[s._v("é‚£ä¹ˆè¿™ä¸ª "),t("code",[s._v("/xx/build.sh")]),s._v(" å†…å®¹ç»è¿‡æµ‹è¯•æœ‰å¦‚ä¸‹çš„ç‰¹æ€§")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("#"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bash\nll\ntouch "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("servers"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("conf"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("testxxxxxxxxx\necho "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello World !"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("å‘½ä»¤ä¼šæ­£å¸¸æ‰§è¡Œï¼Œä½†æ˜¯åªä¼šè¾“å‡º  echo æ‰“å°çš„ä¿¡æ¯ç»™è°ƒç”¨å¤„ã€‚")]),s._v(" "),t("p",[s._v("å‰é¢éªŒè¯äº†æˆ‘ä»¬æ–¹æ¡ˆä¸­çš„å…³é”®éƒ¨åˆ† "),t("strong",[s._v("lua æ‰§è¡Œ sh è„šæœ¬")]),s._v("ï¼Œä¸‹é¢å°±å¼€å§‹çœŸæ­£å®ç°è‡ªåŠ¨æ„å»º")]),s._v(" "),t("h2",{attrs:{id:"vuepress-è‡ªåŠ¨æ„å»º"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vuepress-è‡ªåŠ¨æ„å»º"}},[s._v("#")]),s._v(" vuepress è‡ªåŠ¨æ„å»º")]),s._v(" "),t("p",[s._v("æ­¥éª¤å¦‚ä¸‹ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("å®‰è£… vuepress build çš„è½¯ä»¶ç¯å¢ƒï¼š"),t("a",{attrs:{href:"https://yarn.bootcss.com/docs/install/#centos-stable",target:"_blank",rel:"noopener noreferrer"}},[s._v("yarn"),t("OutboundLink")],1),s._v(" å’Œ "),t("a",{attrs:{href:"https://github.com/zq99299/essay-note/blob/master/chapter/linux/install.md#node",target:"_blank",rel:"noopener noreferrer"}},[s._v("node"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://zq99299.github.io/note-book/posts/linux/git.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("å®‰è£… git è½¯ä»¶"),t("OutboundLink")],1),s._v("ï¼šç”¨äºå…‹éš†ä¸€ä¸ªé¡¹ç›®åˆ°æœ¬åœ°ï¼Œè¿›è¡Œæ‹‰å–æœ€æ–°çš„ç¬”è®°å†…å®¹")]),s._v(" "),t("li",[s._v("ç¼–å†™æ„å»ºè„šæœ¬")]),s._v(" "),t("li",[s._v("é…ç½® nginx è®¿é—®æ„å»ºå¥½çš„é™æ€ç½‘ç«™")]),s._v(" "),t("li",[s._v("åœ¨ Github å¯¹åº”é¡¹ç›®é…ç½® webhook åœ°å€åˆ°æˆ‘ä»¬æä¾›çš„ lua å…¥å£")])]),s._v(" "),t("h3",{attrs:{id:"clone-é¡¹ç›®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#clone-é¡¹ç›®"}},[s._v("#")]),s._v(" clone é¡¹ç›®")]),s._v(" "),t("p",[s._v("æŠŠè¦è‡ªåŠ¨éƒ¨ç½²æ„å»ºçš„é¡¹ç›® clone ä¸‹æ¥ã€‚æˆ‘ä»¬çš„æ„å»ºå’Œå‘å¸ƒç›®å½•éƒ½åœ¨ "),t("code",[s._v("/usr/servers/notework/")]),s._v(" ç›®å½•ä¸‹å±•å¼€")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /usr/servers/notework/gitrepo\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/servers/notework/gitrepo\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## åœ¨è¯¥è·¯å¾„ä¸‹å­˜æ”¾æˆ‘ä»¬çš„ç¬”è®°é¡¹ç›®")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/zq99299/mysql-tutorial.git\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/zq99299/note-book.git\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/zq99299/java-tutorial.git\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/zq99299/linux-tutorial.git\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/zq99299/mq-tutorial.git\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/zq99299/dsalg-tutorial.git\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"ç¼–å†™æ„å»ºè„šæœ¬"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç¼–å†™æ„å»ºè„šæœ¬"}},[s._v("#")]),s._v(" ç¼–å†™æ„å»ºè„šæœ¬")]),s._v(" "),t("p",[s._v("è¿™æ˜¯ä¸€ä¸ªå…¬å…±çš„æ„å»ºè„šæœ¬ï¼Œåœ¨è°ƒç”¨è¯¥è„šæœ¬çš„æ—¶å€™ï¼Œéœ€è¦æŠŠé¡¹ç›®åä¼ é€’è¿›æ¥")]),s._v(" "),t("p",[t("code",[s._v("/usr/servers/notework/build.sh")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ä¸€ä¸ªå·¥ä½œç›®å½•ï¼Œç”¨äºå­˜æ”¾ä»“åº“ã€æ‰“åŒ…åéƒ¨ç½²ç›®å½•")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("noteworkDir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/servers/notework\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ç¬”è®°ä»“åº“åç§°ï¼Œæ¯ä¸ªç¬”è®°ä¸€ä¸ªï¼Œè°ƒç”¨è„šæœ¬æ—¶ï¼Œå°†é¡¹ç›®åä¼ é€’è¿›æ¥")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("noteName")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ›´æ–°é¡¹ç›®ï¼Œå¹¶æ„å»º")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$noteworkDir")]),s._v("/gitrepo/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$noteName")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" pull\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" docs:build\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åˆ é™¤æ„å»ºå¥½çš„åŒ…ï¼Œå¹¶ç”¨æ–°çš„è¦†ç›–")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$noteworkDir")]),s._v("/release/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$noteName")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$noteworkDir")]),s._v("/release/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$noteName")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" build/.vuepress/dist/* "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$noteworkDir")]),s._v("/release/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$noteName")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("é…ç½® nginx è®¿é—®æ„å»ºå¥½çš„é™æ€ç½‘ç«™")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("server {\n    listen       80;\n    server_name  localhost;\n\n    charset utf-8; \n\n    #access_log  logs/host.access.log  main;\n\n    location ^~ /linux-tutorial {\n        # root   /usr/servers/notework/release/linux-tutorial/;\n        alias /usr/servers/notework/release/linux-tutorial/;\n    }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("p",[s._v("éœ€è¦è¯´æ˜ä¸‹çš„æ˜¯ï¼šè¿™é‡Œçš„ location çš„é…ç½®ï¼Œè¿™ä¸ªéœ€è¦çœ‹ä½ çš„ "),t("code",[s._v("docs/.vuepress/config.js")]),s._v(" ä¸­ bash çš„è®¾ç½®ï¼Œç”±äºè¦éƒ¨ç½²åˆ° githubioï¼Œè¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªå‰ç¼€è·¯å¾„ã€‚")]),s._v(" "),t("p",[s._v("ç°åœ¨ï¼Œå¯ä»¥é€šè¿‡ "),t("code",[s._v("http://ä½ çš„ä¸»æœº IP/linux-tutorial/")]),s._v(" è®¿é—®åˆ°è¿™ä¸ªé¡¹ç›®äº†ã€‚")]),s._v(" "),t("h3",{attrs:{id:"ç¼–å†™-lua-è„šæœ¬è‡ªåŠ¨æ„å»ºé€»è¾‘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç¼–å†™-lua-è„šæœ¬è‡ªåŠ¨æ„å»ºé€»è¾‘"}},[s._v("#")]),s._v(" ç¼–å†™ lua è„šæœ¬è‡ªåŠ¨æ„å»ºé€»è¾‘")]),s._v(" "),t("p",[s._v("å‰é¢å†™äº†ä¸€éƒ¨åˆ†ï¼Œè¿™é‡Œåšä¸€ç‚¹ä¿®æ”¹")]),s._v(" "),t("p",[t("code",[s._v("/usr/servers/nginx/conf/noteBuild.lua")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("-- æ‹¿ä¸€ä¸ªåœ°å€æ¥è¯´æ˜ï¼šhttp://eshop-cache03/lua?method"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("hello"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("productId")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n-- è·å–é—®å·åé¢çš„å‚æ•°åˆ—è¡¨\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" uri_args "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ngx.req.get_uri_args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n-- è·å–å‚æ•°\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" token "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" uri_args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"token"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n-- è¿™é‡Œå¢åŠ ä¸€ä¸ª noteName çš„å‚æ•°å€¼ï¼Œéœ€è¦ webhook ä¸­å›è°ƒï¼Œæ¥æ„å»ºä¸åŒçš„é¡¹ç›®\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" noteName "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" uri_args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"noteName"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" checkToken "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456xxx"')]),s._v("\n\n-- å¦‚æœæ²¡æœ‰æä¾› token åˆ™è¾“å‡ºä¸€ä¸ª err ä¿¡æ¯\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" not token "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("  \n    ngx.say"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"request error token is null:"')]),s._v(", err"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  \n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v("  \nend\n\n-- åˆ¤æ–­æ˜¯å¦ä¸ token ç›¸ç­‰\nif"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" token ~"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" checkToken "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n    ngx.say"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"request error token mismatching:"')]),s._v(", err"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  \n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v("  \nend\n\n-- æ£€æŸ¥å½“å‰ç¬”è®°æ˜¯å¦æ”¯æŒè‡ªåŠ¨æ„å»º\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" not noteName "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("  \n    ngx.say"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"request error noteName is null:"')]),s._v(", err"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  \n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v("  \nend\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" supportNotes "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"linux-tutorial"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mysql-tutorial"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v("  isInTable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value,list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" not list "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("   \n   end \n   "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" k, "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("v")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" pairs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("v")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" value "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n\t  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n\tend\n   end\nend \nif"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" not isInTable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("noteName,supportNotes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n    ngx.say"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"request error noteName mismatching:"')]),s._v(", err"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  \n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v("  \nend\n\n-- æ ¡éªŒé€šè¿‡åï¼Œæ‰§è¡Œè„šæœ¬\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" shell "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" require "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"resty.shell"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" args "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    socket "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unix:/tmp/shell.sock"')]),s._v(", \n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("timeout")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("120000")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n-- ä¸åŠ  nohub "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("ç§’å›æ‰§è¡Œè¶…æ—¶ï¼ŒåŠ äº†ä¹‹åï¼Œè²Œä¼¼å—ä¸Šé¢çš„ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("timeout")]),s._v(" æ§åˆ¶ï¼Œä¸æ˜ç™½è¿™ä¸€å—æ˜¯å•¥åŸå› \n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" exeStr "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nohub sh /usr/servers/notework/build.sh "')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("noteName\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" status, out, err "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" shell.execute"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("exeStr, args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nngx.header.content_type "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text/plain"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" out "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n ngx.say"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Result:'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(" out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v("\nend\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n ngx.say"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Result:'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(" err"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v("\nend\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br")])]),t("p",[t("code",[s._v("/usr/servers/nginx/conf/noteBuild.conf")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("server "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  \n    server_name  _"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    charset utf"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  # ä¸­æ–‡ä¸ä¹±ç \n    \n    location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lua "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("  \n      default_type "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'text/html'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  \n      # content_by_lua "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ngx.say(\"hello world\")'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  \n      content_by_lua_file "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("servers"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("conf"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("noteBuild"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lua"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("åŒæ ·éœ€è¦åœ¨ nginx.conf ä¸­å¼•ç”¨è¿™ä¸ª noteBuild.conf æ–‡ä»¶")]),s._v(" "),t("p",[t("strong",[s._v("æ³¨æ„ï¼š")]),s._v(" è¿™é‡Œçš„ conf ä¸­çš„ç›‘å¬ç«¯å£ä¸èƒ½ä¸å‰é¢é…ç½®è®¿é—®é™æ€æ–‡ä»¶çš„ç«¯å£ä¸€è‡´ï¼Œä¸€è‡´çš„è¯ï¼Œå‰é¢çš„é…ç½®å°†è¢«è¦†ç›–ï¼ŒåŒæ ·å¯ä»¥å°†è°ƒç”¨è„šæœ¬çš„è¿™ä»£ç ä¸å‰é¢è®¿é—®é™æ€æ–‡ä»¶çš„é…ç½®åœ¨åŒä¸€ä¸ª server ä¸­ï¼Œå°±ä¸ä¼šå‡ºç°è¿™ç§é—®é¢˜äº†")]),s._v(" "),t("p",[s._v("é…ç½®å®Œæˆä¹‹åå¯ä»¥ç®€å•æµ‹è¯•ä¸‹ï¼Œè®¿é—®åœ°å€ "),t("code",[s._v("http://ä½ çš„ ip/lua?token=123456xxx&noteName=linux-tutorial")]),s._v("ï¼Œæ¯”å¦‚è¿™ä¸ª linux-tutorial æ•´ä¸ªæ„å»ºå“åº”ä¿¡æ¯å¦‚ä¸‹")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('Result:\nAlready up to date.\nyarn install v1.22.4\n[1/4] Resolving packages...\nsuccess Already up-to-date.\nDone in 1.11s.\nyarn run v1.22.4\n$ vuepress build docs\nwait Extracting site metadata...\ntip Apply theme @vuepress/theme-default ...\ntip Apply plugin container (i.e. "vuepress-plugin-container") ...\ntip Apply plugin @vuepress/register-components (i.e. "@vuepress/plugin-register-components") ...\ntip Apply plugin @vuepress/active-header-links (i.e. "@vuepress/plugin-active-header-links") ...\ntip Apply plugin @vuepress/nprogress (i.e. "@vuepress/plugin-nprogress") ...\ntip Apply plugin smooth-scroll (i.e. "vuepress-plugin-smooth-scroll") ...\ntip Apply plugin @vuepress/back-to-top (i.e. "@vuepress/plugin-back-to-top") ...\ntip Apply plugin @vuepress/pwa (i.e. "@vuepress/plugin-pwa") ...\ntip Apply plugin @vuepress/medium-zoom (i.e. "@vuepress/plugin-medium-zoom") ...\ntip Apply plugin @vuepress/search (i.e. "@vuepress/plugin-search") ...\ntip Apply plugin @vssue/vssue (i.e. "@vssue/vuepress-plugin-vssue") ...\ntip Apply plugin code-copy (i.e. "vuepress-plugin-code-copy") ...\ntip Apply plugin @vuepress/last-updated (i.e. "@vuepress/plugin-last-updated") ...\ntip Apply plugin baidu-tongji-analytics (i.e. "vuepress-plugin-baidu-tongji-analytics") ...\ntip Apply plugin baidu-autopush (i.e. "vuepress-plugin-baidu-autopush") ...\nâ„¹ Compiling Client\nâ„¹ Compiling Server\nâœ” Server: Compiled successfully in 53.18s\nâœ” Client: Compiled successfully in 53.67s\nwait Rendering static HTML...\n[2K[1Gwait Generating service worker...\nsuccess Generated static files in build/.vuepress/dist.\n\nDone in 80.58s.\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br")])]),t("h3",{attrs:{id:"é…ç½®-github-webhook-åœ°å€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®-github-webhook-åœ°å€"}},[s._v("#")]),s._v(" é…ç½® github webhook åœ°å€")]),s._v(" "),t("p",[t("img",{attrs:{src:a(1388),alt:"image-20200715131405149"}})]),s._v(" "),t("p",[s._v("å…³äºä¸Šå›¾ä¸­çš„ URLï¼Œæ¢æˆä½ è‡ªå·±çš„ IP å’Œå¼€æ”¾çš„ç«¯å£ï¼Œè¿˜æœ‰å„ç§å‚æ•°ã€‚")]),s._v(" "),t("p",[s._v("ä¹‹åå°±å¯ä»¥æµ‹è¯•ä¸‹ï¼Œå¾€ gitHub ä¸Š push ä¸€ä¸ªæ–‡æ¡£çš„ä¿®æ”¹ï¼Œçœ‹æ˜¯å¦èƒ½è§¦å‘è‡ªåŠ¨æ„å»ºã€‚")]),s._v(" "),t("h2",{attrs:{id:"é…ç½®è‡ªå®šä¹‰åŸŸå"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®è‡ªå®šä¹‰åŸŸå"}},[s._v("#")]),s._v(" é…ç½®è‡ªå®šä¹‰åŸŸå")]),s._v(" "),t("p",[s._v("æœ¬äººçš„ DNS åœ¨ä¸‡ç½‘ï¼Œå®Œå…¨çš„ç½‘å€é‡å®šå‘ï¼Œåªèƒ½åœ¨ä¸‡ç½‘çš„æœºå™¨æ‰å¯ä»¥ï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨è½¬å‘åˆ°ä¸€ä¸ª IP ä¸Šï¼Œæ‰€ä»¥ç¬”è®°è®¿é—®ç«¯å£å°±åªèƒ½æ˜¯ 80 ç«¯å£äº†ï¼Œå…¶ä»–çš„ç«¯å£ä¸æ”¯æŒé…ç½®ã€‚")]),s._v(" "),t("p",[s._v("ä¸‹é¢æ˜¯ä¿®æ”¹åçš„é…ç½®")]),s._v(" "),t("p",[t("code",[s._v("/usr/servers/nginx/conf/nginx.conf")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('worker_processes  1;\n\n#error_log  logs/error.log;\n#error_log  logs/error.log  notice;\n#error_log  logs/error.log  info;\n\n#pid        logs/nginx.pid;\n\n\nevents {\n    worker_connections  1024;\n}\n\n\nhttp {\n    lua_package_path "/usr/servers/lualib/?.lua;;";  \n    lua_package_cpath "/usr/servers/lualib/?.so;;"; \n    # include noteBuild.conf; \n    include       mime.types;\n    default_type  application/octet-stream;\n\n    #log_format  main  \'$remote_addr - $remote_user [$time_local] "$request" \'\n    #                  \'$status $body_bytes_sent "$http_referer" \'\n    #                  \'"$http_user_agent" "$http_x_forwarded_for"\';\n\n    #access_log  logs/access.log  main;\n\n    sendfile        on;\n    #tcp_nopush     on;\n\n    #keepalive_timeout  0;\n    keepalive_timeout  65;\n\n    #gzip  on;\n\n    server {\n        listen       80;\n        server_name  _;\n\n        #charset koi8-r;\n\n        #access_log  logs/host.access.log  main;\n        \n        # å°† github webhook è°ƒç”¨çš„å…¥å£ç§»åŠ¨åˆ°è¿™é‡Œæ¥äº†ï¼Œå…¬ç”¨ä¸€ä¸ªåŸŸå\n        location /note-auto-build {  \n          default_type \'text/html\';    \n          content_by_lua_file /usr/servers/nginx/conf/noteBuild.lua;\n        } \n\n        # æœ‰å‡ ä¸ªç¬”è®°é¡¹ç›®å°±å†™å‡ ä¸ªæŒ‡å‘\n        location ^~ /linux-tutorial {\n          alias /usr/servers/notework/release/linux-tutorial/;\n        }\n    }\n    \n    # è¿™ä¸ªæ˜¯é’ˆå¯¹ä¸åŒåŸŸåçš„é…ç½®\n    # æˆ‘è¿™é‡Œç»™æ¯ä¸€ä¸ªç¬”è®°é¡¹ç›®éƒ½é…ç½®äº†ä¸€ä¸ªäºŒçº§åŸŸå\n    server {\n      server_name linux-tutorial.mrcode.cn;\n      listen 80;\n      # è¿™ä¸ªæ˜¯èƒ½è®¿é—®åˆ° index.html æ–‡ä»¶\n      location / {\n          alias /usr/servers/notework/release/linux-tutorial/;\n      }\n      # è¿™é‡Œæ˜¯å…¼å®¹æœ‰å‰ç¼€çš„ css ç­‰èµ„æºä¸‹è½½ï¼Œç”±äºæˆ‘ä»¬çš„ .vuepress/config.js base ä¸­é…ç½®äº†å‰ç¼€\n      # è¦åŒæ—¶å…¼å®¹èƒ½æ¨é€åˆ° githubio ä¸Šï¼Œè¿™é‡Œå°±åªèƒ½è¿™æ ·æ›²çº¿æ•‘å›½äº†\n      # å®ç°çš„æ•ˆæœå°±æ˜¯è®¿é—® inux-tutorial.mrcode.cn ,å°±èƒ½æ­£å¸¸é˜…è¯»\n      location ^~ /linux-tutorial {\n          alias /usr/servers/notework/release/linux-tutorial/;\n      }\n    }\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br")])]),t("p",[s._v("å…³äºä¸Šé¢çš„é…ç½®ï¼ŒæŒ‰ç…§ä½ è‡ªå·±çš„éœ€æ±‚æ¥ç»„ç»‡æ˜¯å¦ç»™äºŒçº§åŸŸåï¼Œè¿˜æ˜¯ä¸€ä¸ªåŸŸåå°±å…¨éƒ¨æå®š")])])}),[],!1,null,null,null);n.default=e.exports}}]);